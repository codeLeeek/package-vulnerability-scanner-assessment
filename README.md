# package-vulnerability-scanner-assessment

## Purpose
A simple project/solution containing a number of known 3rd party vulnerabilities to test the accuracy and coverage of various tools (both integrated and CLI) in identifying vulnerable third party packages.

** **DISCLAIMER** ** This repository is in no way an endorsement nor condemnation of any of the tools listed. The findings and results contained herein are based off an incredibly small sample size and should **_not_** be used as a measure of the protection gained from any of the tools mentioned. 

## Why
Each vulnerability scanner will likely be curating their own vulnerability database from many different sources (or integrating with an existing vulnerability DB) and verifying that against a projects installed packages. This process involves identifying, researching/assessing and cataloging these vulnerabilities which can involve a considerable resources, as such, it is unlikely any one vulnerability database will encompass all known vulnerabilities.

Some prominent vulnerability databases for scanners include:
+ [Snyk vulnerability DB](https://snyk.io/vuln) : ~780 Nuget vulnerabilities
+ [Github advisory DB](https://github.com/advisories) : ~142 Nuget vulnerabilities 
+ [OSS index](https://ossindex.sonatype.org/) : unknown Nuget vulnerabilities

## Method
A template dotnet core 5 app has been created with a small number of known vulnerable Nuget packages added to the project file. Integrated scanning tools will be setup manually outside of this repository and configured to scan regularly. CLI tools will be manually executed periodically.

### Vulnerability Scanners
+ [Snyk](https://snyk.io/)/Snyk vulnerability DB
  + Enabled as Github Integration.
+ [Dependabot alerts](https://docs.github.com/en/code-security/supply-chain-security/managing-vulnerabilities-in-your-projects-dependencies/about-managing-vulnerable-dependencies)/Github advisory DB
  + Configured in repository settings.
+ [.Net Core CLI](https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-list-package)/Github advisory DB - **_Requires .Net Core SDK 5.0.200+**
  + Executed locally via `dotnet list package --include-transitive'
+ [Sonatype Lift](https://www.sonatype.com/products/sonatype-lift)/OSS index - **_Does not yet support Nuget_**
  + Enabled as Github App
+ [Sonatype DepSheild](https://depshield.github.io/#/)/OSS index - **_Does not yet support Nuget_**
  + Enabled as Github App

### Vulnerable Packages
+ System.Text.Encodings.Web: [5.0.0](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26701)
+ IdentityServer4: [2.1.2](https://app.snyk.io/vuln/SNYK-DOTNET-IDENTITYSERVER4-174371)
+ Microsoft.AspNetCore.Authentication.JwtBearer: [5.0.8](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0820)
+ System.Text.RegularExpressions: [4.3.0](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34532)
+ Angularjs.Core: [1.6.0](https://app.snyk.io/vuln/SNYK-DOTNET-ANGULARJSCORE-1564949)

## Results

### Nuget

| Vulnerability                                 | Snyk             | Dependabot       | .Net Core CLI    | Sonatype Lift    | Sonatype DepSheild |
| --------------------------------------------- |:----------------:|:----------------:|:----------------:|:----------------:|:------------------:|
| System.Text.Encodings.Web                     |:heavy_check_mark:|:heavy_check_mark:|:heavy_check_mark:| :x:              | :x:                |
| IdentityServer4                               |:heavy_check_mark:|:x:               |:heavy_check_mark:| :x:              | :x:                |
| Microsoft.AspNetCore.Authentication.JwtBearer |:heavy_check_mark:|:heavy_check_mark:|:heavy_check_mark:| :x:              | :x:                |
| System.Text.RegularExpressions                |:heavy_check_mark:|:heavy_check_mark:|:heavy_check_mark:| :x:              | :x:                |
| Angularjs.Core                                |:heavy_check_mark:|:x:               |:x:               | :x:              | :x:                |



## Future
Add more projects that utilise the other main package managers e.g. npm, pip, RubyGems etc.